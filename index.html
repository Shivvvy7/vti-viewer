<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>VTI Viewer</title>
  <script src="https://unpkg.com/itk-vtk-viewer@latest/dist/itk-vtk-viewer.js"></script>
  <style>
    html, body {
      height: 100%;
      margin: 0;
      background: #000;
    }
    #viewer {
      height: 100vh;
    }
  </style>
</head>
<body>
  <div id="viewer"></div>
  <script>
    async function loadVTI() {
      try {
        const response = await fetch("https://script.google.com/macros/s/AKfycbxAZnvXFAQmZqvg5uarXmyCfnxOxK6psxfnfECaUgAtekXmxCvzzMI3Vjt7wIAWEA/exec");

        if (!response.ok) {
          throw new Error("❌ Could not fetch file. HTTP " + response.status);
        }

        const blob = await response.blob();
        const file = new File([blob], "latest.vti", { type: blob.type || "application/octet-stream" });

        itkVtkViewer.createViewer(document.getElementById("viewer"), {
          files: [file],
          config: {
            showControls: true,
            allowDrop: false
          }
        });
      } catch (error) {
        console.error("❌ Failed to load file:", error);
        document.body.innerHTML = "<h2 style='color:white;'>❌ Failed to load .vti file<br>Check Console for error.</h2>";
      }
    }

    loadVTI();
  </script>
</body>
</html>
